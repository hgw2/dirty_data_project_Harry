---
title: "Task 4 Analysis"
author: "Harry Williams"
date: "10/11/2020"
output: 
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Packages 
```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
```

## Data
```{r, message=FALSE}

candy_all <- read_csv(here("clean_data/candy_all_clean.csv"),
  col_types =
    cols(
      gender = "c",
      country = "c"
    )
)
```



## Q.1 What is the total number of candy ratings given across the three years. (number of candy ratings, not number of raters. Donâ€™t count missing values)

```{r}
candy_all %>%
  summarise(number_of_candy_reviews = n())
```

## Q.2 What was the average age of people who are going out trick or treating and the average age of people 3. not going trick or treating?

```{r}
candy_all %>%
  group_by(going_out) %>%
  summarise(average_age = mean(age, na.rm = TRUE))
```

## Q3. For each of joy, despair and meh, which candy bar revived the most of these ratings?

```{r}
candy_all %>%
  group_by(candy_type) %>%
  summarise(number_of_review = n()) %>%
  slice_max(number_of_review)
```
However if m&ms are not grouped together then recces cups become the most reviewed

## Q4 How many people rated Starburst as despair?
```{r}
candy_all %>%
  filter(candy_type == "starburst" & rating == "despair") %>%
  tally(name = "number_of_starburst_as_despair")
```

## Q5 For the next three questions, count despair as -1, joy as +1 and meh as 0.

```{r}
candy_rated <- read_csv(here("clean_data/candy_all_rated_clean.csv"),
  col_types =
    cols(
      gender = "c",
      country = "c"
    )
)
```

## Q6 What was the most popular candy bar by this rating system for each gender in the dataset? 
```{r}
candy_rated %>%
  group_by( candy_type) %>%
  summarise(score = sum(rating)) %>%
  slice_max(score, n = 20
            )
```

## Q7 What was the most popular candy bar in each year?
```{r}
candy_rated %>%
  group_by(year, candy_type) %>%
  summarise(score = sum(rating)) %>%
  slice_max(score)
```
## Q8 What was the most popular candy bar by this rating for people in US, Canada, UK and all other countries?
```{r}
candy_rated %>%
  group_by(country, candy_type) %>%
  summarise(score = sum(rating)) %>%
  slice_max(score, with_ties = FALSE)
```
